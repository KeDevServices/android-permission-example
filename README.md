Link zum Blogeintrag: <a href="https://blog.kedev.eu/android-permission-example/">Kedev Blog</a>
Link zu Github: <a href="https://github.com/KeDevServices/android-permission-example" rel="nofollow">android-permission-example</a>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">Im Rahmen meiner Master-Thesis habe ich den Prototypen einer Android-Applikation für Vinocheck (<a href="http://www.vinocheck.com/">www.vinocheck.com</a>) entwickelt. Vinocheck ist ein Portal für Weinliebhaber, das durch KeDev ins Leben gerufen wurde. Mit dem Projekt ist ein unabhängiges Bewertungsportal für Weinerzeugnisse geschaffen worden, auf dem Winzer sich selbst und ihre Weine präsentieren und Konsumenten eben diese bewerten können. Die Fragestellung der Master-Thesis lautete:</span></span></span>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">"Wie kann eine mobile Applikation entwickelt werden, so dass der Anwender ad hoc und unabhängig von Ort und Zeit eine Weinauswahl auf Basis der eigenen Kollektion oder generell anhand seiner Bedürfnisse treffen kann?"</span></span></span>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">Das Ziel der Vinocheck App ist die Übertragung von Funktionsweisen der Vinocheck-Webseite in eine nativ entwickelte Smartphone-Applikation. Um der App einen Mehrwert zu liefern, wurden ein virtueller Weinkeller realisiert. In diesem können Weinbestände verwaltet werden und er wird bei der Weinempfehlung zu Rate gezogen. Als Ergebnis entstand ein Prototyp der Vinocheck App. Durch den Einsatz von aktiven (virtueller Weinkeller mit Speisefilter) und passiven Funktionen (statistische Datenerhebung zur Erstellung des Geschmacksprofils) konnte die Zielsetzung erfüllt werden. Der Nutzer erhält mit der App bei Bedarf Weinempfehlungen zu Speisen auf Basis seines Geschmacks und des vorhandenen Weinbestandes.</span></span></span>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">Die Applikation wurde mit dem Entwicklungstool Android Studio entwickelt und kommunizierte über REST-Services mit der Hauptanwendung. Neben Besonderheiten bei der Berechtigungssteuerung seit Android in Version 6 (Marshmallow) wurden viele Erkenntnisse mit Android „Material Design“, der Internationalisierung und allgemeinen Themen der Entwicklung von Smartphone-Applikationen gewonnen. </span></span></span>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">In meinem ersten Blogeintrag möchte ich speziell über die Erkenntnisse der Berechtigungssteuerung berichten. Zum einen war uns wichtig wenige Berechtigungen beim Anwender zu erfragen. Zum anderen musste bedacht werden, dass mit der Einführung von Android 6 der Nutzer jederzeit unserer App die Berechtigungen (der Kategorie „Dangerous“) entziehen kann.</span></span></span>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">Weniger Berechtigungen konnten wir realisieren, in dem man System-Intents verwendet (siehe </span></span></span><a href="http://developer.android.com/training/articles/user-data-permissions.html"><span style="font-family: Calibri, sans-serif;">http://developer.android.com/training/articles/user-data-permissions.html</span></a><span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">). Als Beispiel kann man die Bildaufnahme der Kamera nehmen. Die Kamera-Berechtigung gilt als Dangerous Permission, die die Privatsphäre des Nutzers stark beeinträchtigen kann. Mittels dieser Intents konnte die Bildaufnahme durchgeführt werden, ohne die Kamera-Berechtigung (&lt;uses-permission android:name="android.permission.CAMERA"/&gt;) </span></span></span><span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">vom Nutzer zu erlangen.</span></span></span>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">Mit der neuen Berechtigungssteuerung muss zur Laufzeit geprüft werden, ob die Geräte-Funktionen der App zur Verfügung stehen. Hierfür werden glücklicherweise Methoden von Android zur Verfügung gestellt. Die Methode <span style="font-family: 'Courier New', monospace;"><span style="font-size: small;">ContextCompat.checkSelfPermission()</span></span> liefert die Information, ob die Berechtigung gegeben wurde. Ist dies nicht der Fall kann die Berechtigung mit einem entsprechenden Hinweis zur Laufzeit mittels der Methode <span style="font-family: 'Courier New', monospace;"><span style="font-size: small;">ActivityCompat.requestPermissions()</span></span> erfragt werden. Nachfolgend ist ein Beispiel in Form von Pseudo-Code über dieses Handling dargestellt:</span></span></span>
<pre><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">if (...checkSelfPermission(...READ_CONTACTS) != ...PERMISSION_GRANTED){
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">  if (...shouldShowRequestPermissionRationale(...READ_CONTACTS)){
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">    // Give explanation and request the permission
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">    ...requestPermissions(...REQUEST_READ_CONTACTS);
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">  } else {
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">    // If permission needs no explanation request it directly
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">    ...requestPermissions(...REQUEST_READ_CONTACTS);
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">  }
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">} else {
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">  // Do something with the given permission
</span></span><span style="font-family: 'Courier New', monospace;"><span style="font-size: xx-small;">}</span></span></pre>
<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">Tipps für Usability und User Experience werden seitens Android für diese Thematik ebenfalls geliefert. Dem Nutzer sollte nach Möglichkeit im Kontext erklärt werden, wofür eine Berechtigung benötigt wird. Basis-Funktionalitäten sollten immer zum Anfang mit entsprechender Erläuterung erfragt werden. Eine wichtige Methode in diesem Szenario ist </span></span></span><a href="http://developer.android.com/reference/android/support/v4/app/ActivityCompat.html#shouldShowRequestPermissionRationale(android.app.Activity,%20java.lang.String)">shouldShowRequestPermissionRationale</a><span style="font-family: 'Courier New', monospace;"><span style="font-size: small;">().</span></span><span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;"> Die Methode liefert die Information, ob im Vorfeld die notwendige Berechtigung bereits abgelehnt wurde. Dadurch kann beim ersten Erfragen ein kompakter Nachfrage-Dialog genutzt werden und bei einem weiteren Mal eine ausführliche Erklärung folgen.</span></span></span>

<span style="color: #000000;"><span style="font-family: Calibri, sans-serif;"><span style="font-size: medium;">Mit diesen Erkenntnissen konnten wir ein gutes Konzept für den Einsatz von standortbasierten Push Notifications erstellen. Über weitere Erkenntnisse im Bereich von Usability und User Experience werde ich zu einem späteren Zeitpunkt berichten.</span></span></span>
